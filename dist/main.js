!function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){let n="";class s{constructor(e,t,n,s){this.name=e,this.link=t,this.id=n,this.cardContainer=this.create(s)}like(e){e.target.classList.toggle("place-card__like-icon_liked")}remove(e){window.confirm("Вы действительно хотите удалить эту карточку?")&&k.deleteCard(this.id,t=>{e.target.closest(".place-card").remove()})}create(e){const t=document.createElement("div");t.classList.add("place-card");const n=document.createElement("div");t.appendChild(n),n.classList.add("place-card__image"),n.setAttribute("style","background-image: url("+this.link+")");const s=document.createElement("button");n.appendChild(s),e?s.classList.add("place-card__delete-icon"):s.classList.add("place-card__delete-icon_none");const o=document.createElement("div");t.appendChild(o),o.classList.add("place-card__description");const r=document.createElement("h3");o.appendChild(r),r.classList.add("place-card__name"),r.textContent=this.name;const a=document.createElement("button");return o.appendChild(a),a.classList.add("place-card__like-icon"),t.setAttribute("id",this.id),t}}class o{constructor(e){this.container=e}open(){this.container.classList.add("popup_is-opened")}close(){this.container.classList.remove("popup_is-opened")}}const r=document.querySelector(".button"),a=document.querySelector(".places-list"),i=document.forms.new,c=document.querySelector(".popup__button"),d=document.querySelector(".user-info__button-edit"),l=document.forms.data,u=document.querySelectorAll(".popup__close"),p=document.querySelector(".popup_first"),m=document.querySelector(".popup_second"),h=document.querySelector(".image"),_=document.querySelector(".image__content"),f=document.querySelector(".popups"),b=document.querySelector(".user-info__name"),v=document.querySelector(".user-info__job"),g=document.querySelector(".user-info__photo"),y=new class{constructor(e){this.container=e,this.cards=[]}addCard(e){let t;t=e.owner._id===n;const o=new s(e.name,e.link,e._id,t);this.cards.push(o),this.container.appendChild(o.cardContainer)}likeCard(e,t){const n=this.cards.find(e=>e.id===t);null!==n&&n.like(e)}deleteCard(e,t){const n=this.cards.find(e=>e.id===t);null!==n&&n.remove(e)}}(a),L=new o(p),C=new o(m),k=new class{constructor(e){this.options=e}getInitialCards(e){return this.process(fetch(`${this.options.baseUrl}/cards`,{headers:this.options.headers}),e)}getUserInfo(e){return this.process(fetch(`${this.options.baseUrl}/users/me`,{headers:this.options.headers}),e)}updateUserInfo(e,t,n){this.process(fetch(`${this.options.baseUrl}/users/me`,{method:"PATCH",headers:this.options.headers,body:JSON.stringify({name:e,about:t})}),n)}process(e,t){e.then(e=>e.ok?e.json():Promise.reject(`Ошибка: ${e.status}`)).then(t).catch(e=>console.log(e))}postCard(e,t,n){this.process(fetch(`${this.options.baseUrl}/cards`,{method:"POST",headers:this.options.headers,body:JSON.stringify({name:e,link:t})}),n)}deleteCard(e,t){this.process(fetch(`${this.options.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.options.headers}),t)}}({baseUrl:"http://95.216.175.5/cohort3",headers:{authorization:"0d5b5599-695b-4d75-afbb-16b992ef7f36","Content-Type":"application/json"}});function E(e){var t;t=e.target,document.querySelector(`#error-${t.id}`).classList.remove("error-message_is-displayed"),function(e){const t=document.querySelector(`#error-${e.id}`);if(!e.checkValidity())return t.textContent="Это обязательное поле",S(t),!1;if(e.value.length<2||e.value.length>30)return S(t),t.textContent="Должно быть от 2 до 30 символов",!1}(e.target)}function S(e){e.classList.add("error-message_is-displayed")}function q(e){return e.startsWith("http")}k.getUserInfo(e=>{b.textContent=e.name,v.textContent=e.about,g.style.backgroundImage=`url(${e.avatar})`,n=e._id}),k.getInitialCards(e=>{e.forEach(e=>y.addCard(e))}),u.forEach((function(e){e.addEventListener("click",()=>L.close())})),u.forEach((function(e){e.addEventListener("click",()=>C.close())})),i.addEventListener("input",(function(e){const t=i.elements.name,n=i.elements.link;0!==t.value.length&&0!==n.value.length&&q(n.value)?c.removeAttribute("disabled"):c.setAttribute("disabled",!0)})),i.addEventListener("input",(function(e){const t=i.elements.name,n=i.elements.link;0!==t.value.length&&0!==n.value.length&&q(n.value)?c.classList.add("popup__button_black"):c.classList.remove("popup__button_black")})),i.addEventListener("submit",(function(e){e.preventDefault();const t=i.elements.name,n=i.elements.link;k.postCard(t.value,n.value,e=>{y.addCard(e)}),L.close(),i.reset(),c.setAttribute("disabled",!0),c.classList.remove("popup__button_black")})),r.addEventListener("click",()=>L.open()),d.addEventListener("click",(function(e){j[1].classList.add("popup__button_black");const t=document.forms.data,n=t.elements.name,s=t.elements.job,o=document.querySelector(".user-info__name"),r=document.querySelector(".user-info__job");n.value=o.textContent,s.value=r.textContent,C.open()})),l.addEventListener("submit",(function(e){e.preventDefault();const t=document.forms.data,n=t.elements.name,s=t.elements.job;k.updateUserInfo(n.value,s.value,e=>{b.textContent=e.name,v.textContent=e.about}),i.reset(),C.close()}));const j=document.querySelectorAll(".popup__button");l.addEventListener("input",(function(e){const t=document.forms.data,n=t.elements.name,s=t.elements.job,o=n.value.length<2||n.value.length>30;s.value.length<2||s.value.length>30||o?(j[1].classList.remove("popup__button_black"),j[1].setAttribute("disabled",!0)):(j[1].classList.add("popup__button_black"),j[1].removeAttribute("disabled"))})),a.addEventListener("click",(function(e){if(e.target.classList.contains("place-card__image")){h.classList.add("image_is-opened");const t=e.target.getAttribute("style"),n=document.createElement("img");let s=t.replace("background-image: url(","").replace(")","");n.setAttribute("src",s),n.classList.add("image__element"),_.appendChild(n)}})),f.addEventListener("click",(function(e){if(e.target.classList.contains("image__close")){h.classList.remove("image_is-opened");const e=_.querySelectorAll("img");_.removeChild(e[1])}})),l.name.addEventListener("input",E),l.job.addEventListener("input",E),c.setAttribute("disabled",!0),a.addEventListener("click",(function(e){e.target.classList.contains("place-card__like-icon")&&y.likeCard(event,e.target.closest(".place-card").getAttribute("id")),e.target.classList.contains("place-card__delete-icon")&&y.deleteCard(event,e.target.closest(".place-card").getAttribute("id"))}))}]);